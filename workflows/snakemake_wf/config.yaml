# ================================================================================
# tldr Snakemake Workflow Configuration
# Container-only execution with Singularity
# Supports paired/multiple BAMs per patient
# ================================================================================

# Samples file (TSV format with columns: patient, sample, condition, path, genome)
# Samples are grouped by patient - all BAMs for the same patient are analyzed together
# This enables tumor/normal comparisons, case/control pairs, timepoint analysis, etc.
#
# Example for paired tumor/normal:
#   patient	sample	condition	path	genome
#   patientA	patientA_tumor	tumor	/path/to/tumor.bam	hg38
#   patientA	patientA_normal	normal	/path/to/normal.bam	hg38
#
# tldr will receive: --bams /path/to/tumor.bam,/path/to/normal.bam
samples: "samples.tsv"

# Output directory for results
outdir: "results"

# ================================================================================
# Reference Files
# ================================================================================

# Reference genome (FASTA, must be indexed with samtools faidx)
# This should match the 'genome' column in samples.tsv
reference_genome: "/path/to/reference/genome.fa"

# TE reference file (inside container)
# Options:
#   - /opt/tldr/ref/teref.ont.human.fa  (ONT-optimized human) [RECOMMENDED]
#   - /opt/tldr/ref/teref.human.fa      (standard human)
#   - /opt/tldr/ref/teref.mouse.fa      (mouse)
te_reference: "/opt/tldr/ref/teref.ont.human.fa"

# Non-reference collection (optional, inside container)
# Set to null or comment out if not using
# Options:
#   - /opt/tldr/ref/nonref.collection.hg38.chr.bed.gz   (hg38 with chr prefix)
#   - /opt/tldr/ref/nonref.collection.hg38.bed.gz       (hg38 without chr)
#   - /opt/tldr/ref/nonref.collection.hg19.chr.bed.gz   (hg19 with chr prefix)
#   - /opt/tldr/ref/nonref.collection.hg19.bed.gz       (hg19 without chr)
#   - /opt/tldr/ref/nonref.collection.mm10.chr.bed.gz   (mm10 with chr prefix)
#   - /opt/tldr/ref/nonref.collection.mm10.bed.gz       (mm10 without chr)
nonref_collection: null  # "/opt/tldr/ref/nonref.collection.hg38.chr.bed.gz"

# ================================================================================
# Container Settings
# ================================================================================

# Docker/Singularity container image
# Will be pulled from DockerHub and cached by Snakemake
container: "docker://sahuno/tldr:latest"

# ================================================================================
# SLURM Resource Defaults
# ================================================================================
# These are used when running with the slurmConfig profile
# Can be overridden in the profile or per-rule in set-resources

# SLURM account
slurm_account: "greenbab"

# Default partition
slurm_partition: "componc_cpu"

# Threads per job
threads: 4

# Memory per CPU (MB)
mem_mb_per_cpu: 8000

# Runtime per job (minutes)
runtime: 240

# ================================================================================
# tldr Parameters
# ================================================================================

# Default parameters (built into workflow):
#   --min_te_len 100          # Minimum insertion size (workflow default)
#   --max_cluster_size 100    # Limit cluster size with embed-biased downsampling
#   --trdcol                  # Add columns for transduction mapping
#   --detail_output           # Output per-insertion BAMs and mapping info
#   --extend_consensus 5000   # Extend per-sample consensus by 5kb (requires --detail_output)
#   --methylartist            # Generate methylartist commands
#   --keep_pickles            # Keep per-chromosome pickle files
#   --color_consensus         # Add color to consensus sequences
#   -p {threads}              # Use specified thread count

# Additional tldr parameters (override or extend defaults)
# Common options:
#   --minreads 5              # Minimum read count to form cluster (default: 3)
#   --min_te_len 200          # Override minimum insertion size
#   --max_te_len 10000        # Maximum insertion size (default: 10000)
#   --strict                  # Apply additional filters
#   --somatic                 # Predict somatic insertions (enables --strict)
#   --wiggle 50               # Interval padding for breakpoint search (default: 50)
#   --flanksize 500           # Flank size for read trimming (default: 500)
tldr_params: ""

# ================================================================================
# Workflow Options
# ================================================================================

# Create summary statistics
create_summary: true

# Keep intermediate files
keep_intermediate: false
